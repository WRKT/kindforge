# Global settings
global:
  domain: argocd.kindforge-cl01.io

# Server configuration
server:
  additionalApplications:
    - name: cl01-ops-backups
      namespace: argocd
      project: default
      source:
        repoURL: https://gitlab.com/holokube/hlk01.git
        targetRevision: HEAD
        path: clusters/kindforge-cl01/backups
      destination:
        server: https://kubernetes.default.svc
        namespace: velero
      syncPolicy:
        automated:
          prune: true
          selfHeal: true
        syncOptions:
          - CreateNamespace=true

    - name: cl01-ops-restores
      namespace: argocd
      project: default
      source:
        repoURL: https://gitlab.com/holokube/hlk01.git
        targetRevision: HEAD
        path: clusters/kindforge-cl01/restores
      destination:
        server: https://kubernetes.default.svc
        namespace: velero
      syncPolicy:
        automated:
          prune: true
          selfHeal: true
        syncOptions:
          - CreateNamespace=true

    - name: cl01-ops-schedules
      namespace: argocd
      project: default
      source:
        repoURL: https://gitlab.com/holokube/hlk01.git
        targetRevision: HEAD
        path: clusters/kindforge-cl01/schedules
      destination:
        server: https://kubernetes.default.svc
        namespace: velero
      syncPolicy:
        automated:
          prune: true
          selfHeal: true
        syncOptions:
          - CreateNamespace=true

    # --- CLUSTER 02 ---
    # Uncomment when cluster is added via 'argocd cluster add kindforge-cl02'
    # - name: cl02-ops-backups
    #   namespace: argocd
    #   project: default
    #   source:
    #     repoURL: https://gitlab.com/holokube/hlk01.git
    #     targetRevision: HEAD
    #     path: clusters/kindforge-cl02/backups
    #   destination:
    #     name: kindforge-cl02
    #     namespace: velero
    #   syncPolicy:
    #     automated:
    #       prune: true
    #       selfHeal: true
    #     syncOptions:
    #       - CreateNamespace=true

    # - name: cl02-ops-restores
    #   namespace: argocd
    #   project: default
    #   source:
    #     repoURL: https://gitlab.com/holokube/hlk01.git
    #     targetRevision: HEAD
    #     path: clusters/kindforge-cl02/restores
    #   destination:
    #     name: kindforge-cl02
    #     namespace: velero
    #   syncPolicy:
    #     automated:
    #       prune: true
    #       selfHeal: true
    #     syncOptions:
    #       - CreateNamespace=true

    # - name: cl02-ops-schedules
    #   namespace: argocd
    #   project: default
    #   source:
    #     repoURL: https://gitlab.com/holokube/hlk01.git
    #     targetRevision: HEAD
    #     path: clusters/kindforge-cl02/schedules
    #   destination:
    #     name: kindforge-cl02
    #     namespace: velero
    #   syncPolicy:
    #     automated:
    #       prune: true
    #       selfHeal: true
    #     syncOptions:
    #       - CreateNamespace=true

  ingress:
    enabled: true
    ingressClassName: nginx
    annotations:
      cert-manager.io/cluster-issuer: local-ca-issuer
      nginx.ingress.kubernetes.io/ssl-passthrough: "false"
      nginx.ingress.kubernetes.io/backend-protocol: "HTTP"
    hosts:
      - argocd.kindforge-cl01.io
    tls:
      - secretName: argocd-server-tls
        hosts:
          - argocd.kindforge-cl01.io
    https: true

  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits:
      cpu: 500m
      memory: 512Mi

controller:
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 1Gi

repoServer:
  resources:
    requests:
      cpu: 50m
      memory: 128Mi
    limits:
      cpu: 200m
      memory: 512Mi

redis:
  resources:
    requests:
      cpu: 50m
      memory: 64Mi
    limits:
      cpu: 200m
      memory: 256Mi

applicationSet:
  enabled: false

notifications:
  enabled: false

configs:
  params:
    # Disable TLS on server. Handled by Ingress
    server.insecure: true
